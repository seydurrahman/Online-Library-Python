{% extends 'library/base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container">
  <h2>Books</h2>

<form method="get" action="">
  {{ form|crispy }}
  <input type="text" name="q" placeholder="Search title or author" value="{{ q }}">
 <select name="category">
  <option value="">All categories</option>
  {% for c in categories %}
    <option value="{{ c.id }}" {% if selected_cat|stringformat:"s" == c.id|stringformat:"s" %}selected{% endif %}>
      {{ c.name }}
    </option>
  {% endfor %}
</select>
  <button type="submit">Search / Filter</button>
</form>

<ul>
  {% for book in books %}
    <li>
      <a href="{{ book.get_absolute_url }}">{{ book.title }}</a> by {{ book.author }}
      {% if book.average_rating %}
        â€” Rating: {{ book.average_rating }} ({{ book.reviews_count }} reviews)
      {% endif %}
    </li>
  {% empty %}
    <li>No books found.</li>
  {% endfor %}
</ul>
</div>
{% endblock %}


